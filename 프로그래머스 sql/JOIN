없어진 기록 찾기
SELECT A.ANIMAL_ID, A.NAME 
FROM ANIMAL_OUTS A LEFT JOIN ANIMAL_INS B
ON A.ANIMAL_ID = B.ANIMAL_ID
WHERE B.ANIMAL_ID IS NULL
ORDER BY A.ANIMAL_ID


있었는데요 없었습니다
SELECT o.ANIMAL_ID, o.NAME FROM ANIMAL_OUTS as o
JOIN ANIMAL_INS as i ON i.ANIMAL_ID=o.ANIMAL_ID
WHERE i.DATETIME > o.DATETIME -- 보호시작일(i)보다 입양일(o)이 빠른
ORDER BY i.DATETIME


오랜 기간 보호한 동물
SELECT NAME, DATETIME FROM ANIMAL_INS
WHERE ANIMAL_ID NOT IN (SELECT ANIMAL_ID FROM ANIMAL_OUTS)
ORDER BY DATETIME
LIMIT 3


보호소에서 중성화한 동물
SELECT ANIMAL_ID, ANIMAL_TYPE, NAME FROM ANIMAL_OUTS
WHERE (SEX_UPON_OUTCOME = 'Neutered Male' OR SEX_UPON_OUTCOME = 'Neutered Female' OR
       SEX_UPON_OUTCOME = 'Spayed Male' OR SEX_UPON_OUTCOME = 'Spayed Female')
AND ANIMAL_ID IN (SELECT ANIMAL_ID FROM ANIMAL_INS
                  WHERE SEX_UPON_INTAKE = 'Intact Male' OR SEX_UPON_INTAKE = 'Intact Female')
ORDER BY ANIMAL_ID
